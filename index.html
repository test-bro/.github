<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pinterest Style Webapp</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body class="bg-gray-100">

  <!-- Profile (top-left) -->
  <div id="profileDisplay" class="fixed top-4 left-4 flex items-center space-x-2 bg-white shadow-lg p-2 rounded-lg hidden z-50">
    <img id="profilePicSmall" class="w-10 h-10 rounded-full border">
    <span id="profileNameSmall" class="font-semibold"></span>
  </div>

  <!-- Image Grid -->
  <div id="imageGrid" class="columns-2 md:columns-3 gap-3 p-4"></div>

  <!-- User Form -->
  <div id="userForm" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white p-6 rounded-xl shadow-lg space-y-3 w-80">
      <h2 class="text-lg font-bold">Enter Your Info</h2>
      <input id="name" type="text" placeholder="Your Name" class="w-full border p-2 rounded">
      <input id="phone" type="text" placeholder="Phone (optional)" class="w-full border p-2 rounded">
      <input id="profession" type="text" placeholder="Profession (optional)" class="w-full border p-2 rounded">
      <input id="photo" type="file" accept="image/*" class="w-full border p-2 rounded">
      <button onclick="saveUser()" class="bg-blue-500 text-white px-4 py-2 rounded w-full">Save</button>
    </div>
  </div>

  <!-- Modal -->
  <div id="modal" class="fixed inset-0 bg-black bg-opacity-70 hidden z-40 flex items-center justify-center">
    <div class="bg-white rounded-xl shadow-xl max-w-md w-full relative p-4 flex flex-col items-center">
      <!-- Close Button -->
      <button onclick="closeModal()" class="absolute top-2 right-2 text-gray-700 hover:text-red-500 text-lg">‚úï</button>

      <!-- Image (centered) -->
      <div id="captureArea" class="w-full flex flex-col items-center">
        <img id="modalImage" class="w-full rounded-xl shadow-md" crossorigin="anonymous">

        <!-- User info below image -->
        <div class="mt-4 flex items-center space-x-3 w-full">
          <img id="modalProfilePic" class="w-12 h-12 rounded-full border-2 border-blue-400 shadow-md">
          <div>
            <p id="modalProfileName" class="font-semibold text-base text-gray-800"></p>
            <p id="modalProfileExtra" class="text-sm text-gray-500"></p>
          </div>
        </div>
      </div>

      <!-- Buttons -->
      <div class="flex space-x-3 mt-6 w-full">
        <button onclick="downloadImage()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg shadow-md transition">
          ‚¨áÔ∏è Download
        </button>
        <button onclick="shareImage()" class="flex-1 bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg shadow-md transition">
          üì§ Share
        </button>
      </div>
    </div>
  </div>

<script>
const images = [
  {url: "images/img1.jpg"},
  {url: "images/img2.jpg"},
  {url: "images/img3.jpg"},
  {url: "images/img4.jpg"},
  {url: "images/img5.jpg"},
  {url: "images/img6.jpg"}
];

let userData = JSON.parse(localStorage.getItem("userData")) || null;

function renderGrid() {
  const grid = document.getElementById("imageGrid");
  grid.innerHTML = "";
  images.forEach((img) => {
    const el = document.createElement("img");
    el.src = img.url;
    el.crossOrigin = "anonymous";
    el.className = "mb-3 w-full rounded-lg cursor-pointer hover:opacity-80 shadow";
    el.onclick = () => openModal(img.url);
    grid.appendChild(el);
  });
}

function saveUser() {
  const name = document.getElementById("name").value;
  const phone = document.getElementById("phone").value;
  const profession = document.getElementById("profession").value;
  const photoFile = document.getElementById("photo").files[0];
  if (!name || !photoFile) return alert("Name and photo required!");

  const reader = new FileReader();
  reader.onload = () => {
    userData = {name, phone, profession, photo: reader.result};
    localStorage.setItem("userData", JSON.stringify(userData));
    document.getElementById("userForm").classList.add("hidden");
    showProfile();
  };
  reader.readAsDataURL(photoFile);
}

function showProfile() {
  if (!userData) return;
  document.getElementById("profileDisplay").classList.remove("hidden");
  document.getElementById("profilePicSmall").src = userData.photo;
  document.getElementById("profileNameSmall").innerText = userData.name;
}

function openModal(url) {
  document.getElementById("modal").classList.remove("hidden");
  document.getElementById("modalImage").src = url;
  document.getElementById("modalProfilePic").src = userData.photo;
  document.getElementById("modalProfileName").innerText = userData.name;
  document.getElementById("modalProfileExtra").innerText = 
    [userData.phone, userData.profession].filter(Boolean).join(" ‚Ä¢ ");
}

function closeModal() {
  document.getElementById("modal").classList.add("hidden");
}

async function downloadImage() {
  const capture = document.getElementById("captureArea");
  const canvas = await html2canvas(capture, {useCORS: true, allowTaint: true});
  const link = document.createElement("a");
  link.download = "generated-image.jpg";
  link.href = canvas.toDataURL("image/jpeg");
  link.click();
}

async function shareImage() {
  const capture = document.getElementById("captureArea");
  const canvas = await html2canvas(capture, {useCORS: true, allowTaint: true});
  canvas.toBlob(blob => {
    const file = new File([blob], "generated.jpg", {type: "image/jpeg"});
    if (navigator.share) {
      navigator.share({files: [file]});
    } else {
      alert("Sharing not supported, use Download instead.");
    }
  }, "image/jpeg");
}

window.onload = () => {
  renderGrid();
  if (userData) {
    document.getElementById("userForm").classList.add("hidden");
    showProfile();
  }
};
</script>
</body>
</html>
